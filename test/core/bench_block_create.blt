#: --skip-racket --blimp-timeout 0.6

# Block creation benchmark. Benchmarks the creation of 1 million blocks, some
# of which have a non-empty scope and some of which do not.

go10{:=|{do|
    {block|.};
    {scope|x{:=|1};y{:=|2};z{:=|3}}{.eval|.};
    {block|.};
    {scope|x{:=|1};y{:=|2};z{:=|3}}{.eval|.};
    {block|.};
    {scope|x{:=|1};y{:=|2};z{:=|3}}{.eval|.};
    {block|.};
    {scope|x{:=|1};y{:=|2};z{:=|3}}{.eval|.};
    {block|.};
    {scope|x{:=|1};y{:=|2};z{:=|3}}{.eval|.};
    .
}};

go100{:=|{do|
    go10{.get|.}{.eval|.};
    go10{.get|.}{.eval|.};
    go10{.get|.}{.eval|.};
    go10{.get|.}{.eval|.};
    go10{.get|.}{.eval|.};
    go10{.get|.}{.eval|.};
    go10{.get|.}{.eval|.};
    go10{.get|.}{.eval|.};
    go10{.get|.}{.eval|.};
    go10{.get|.}{.eval|.};
    .
}};

go1000{:=|{do|
    go100{.get|.}{.eval|.};
    go100{.get|.}{.eval|.};
    go100{.get|.}{.eval|.};
    go100{.get|.}{.eval|.};
    go100{.get|.}{.eval|.};
    go100{.get|.}{.eval|.};
    go100{.get|.}{.eval|.};
    go100{.get|.}{.eval|.};
    go100{.get|.}{.eval|.};
    go100{.get|.}{.eval|.};
    .
}};

go10000{:=|{do|
    go1000{.get|.}{.eval|.};
    go1000{.get|.}{.eval|.};
    go1000{.get|.}{.eval|.};
    go1000{.get|.}{.eval|.};
    go1000{.get|.}{.eval|.};
    go1000{.get|.}{.eval|.};
    go1000{.get|.}{.eval|.};
    go1000{.get|.}{.eval|.};
    go1000{.get|.}{.eval|.};
    go1000{.get|.}{.eval|.};
    .
}};

go100000{:=|{do|
    go10000{.get|.}{.eval|.};
    go10000{.get|.}{.eval|.};
    go10000{.get|.}{.eval|.};
    go10000{.get|.}{.eval|.};
    go10000{.get|.}{.eval|.};
    go10000{.get|.}{.eval|.};
    go10000{.get|.}{.eval|.};
    go10000{.get|.}{.eval|.};
    go10000{.get|.}{.eval|.};
    go10000{.get|.}{.eval|.};
    .
}};

go1000000{:=|{do|
    go100000{.get|.}{.eval|.};
    go100000{.get|.}{.eval|.};
    go100000{.get|.}{.eval|.};
    go100000{.get|.}{.eval|.};
    go100000{.get|.}{.eval|.};
    go100000{.get|.}{.eval|.};
    go100000{.get|.}{.eval|.};
    go100000{.get|.}{.eval|.};
    go100000{.get|.}{.eval|.};
    go100000{.get|.}{.eval|.};
    .
}};

go1000000{.get|.}{.eval|.};

.
